
@{
    ViewBag.Title = "cGraphic";
    var UrlloadVotation = Url.Action("VotationCreated", "ApiVotation");
    var UrlloadTypeGraphic = Url.Action("TypeGraphic", "ApiVotation");
    var UrllcreateGraphic = Url.Action("UploadImage", "ApiVotation");
}
<script>
        function loadVotation() {
            $.get('/ApiVotation/VotationCreated', function (data, status) {
                $.each(data, function (key, votation) {
                    $("#cboVotation").append('<option value=' + votation.id + '>' + votation.title + '</option>');
                });
            });
    }
            function loadTypeGraphic() {
            $.get('/ApiVotation/TypeGraphic', function (data, status) {
                $.each(data, function (key, graphic) {
                    $("#cboGrafico").append('<option value=' + graphic.id + '>' + graphic.descripcion + '</option>');
                });
            });
    }

    function createGraphic() {

        if (window.FormData !== undefined) {
            var fileUpload = $("#txtImage").get(0);
            var files = fileUpload.files;

            var fileData = new FormData();
            for (var i = 0; i < files.length; i++) {
                fileData.append(files[i].name, files[i]);
            }
            fileData.append('VotationId', $("#cboVotation").val());
            fileData.append('GraphicId', $("#cboGrafico").val());
            fileData.append('Width', $("#txtwidth").val());
            fileData.append('Height', $("#txtheight").val());

            $.ajax({
                url:'/ApiVotation/UploadImage',
                type: "POST",
                contentType: false, // Not to set any content header
                processData: false, // Not to process data
                data: fileData,
                success: function (result) {
                    alert("Gràfico registrado correctamente");
                    window.location.href = '/Home/IndexVotation';
                    loadQuestion();
                },
                error: function (err) {
                    alert(err.statusText);
                }
            });
        }
        else {
            alert("FormData is not supported.");
        }
    }
    
    window.onload = function () {
        loadVotation();
        loadTypeGraphic();
    }
</script>
<div class="card">
    <div class="card-body">
        <h4 class="box-title">Grafico </h4>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="card-body">
                <form>
                    <div class="form-group row">
                        <label for="staticEmail" class="col-sm-4 col-form-label">Votaciòn</label>
                        <div class="col-sm-6">
                            <select class="form-control" id="cboVotation">
                                <option value="0">Seleccione</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="staticEmail" class="col-sm-4 col-form-label">Tipo de Gràfico</label>
                        <div class="col-sm-6">
                            <select class="form-control" id="cboGrafico">
                                <option value="0">Seleccione</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-sm-4 col-form-label" for="exampleFormControlFile1">Imagen de Fondo</label>
                        <div class="col-sm-6">
                            <input type="file" class="form-control-file" id="txtImage">
                        </div>
                    </div>
                    <div class="form-group row" id="Divopcion2">
                        <label for="staticEmail" class="col-sm-4 col-form-label">Width</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="txtwidth">
                        </div>
                    </div>
                    <div class="form-group row" id="Divopcion2">
                        <label for="staticEmail" class="col-sm-4 col-form-label">Height</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="txtheight">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="staticEmail" class="col-sm-4 col-form-label">Fondo Transparente</label>
                        <div class="col-sm-6">
                            <input type="checkbox" class="form-check-input form-control" id="chckDiapositiva" onclick="isDiapoActive();">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="staticEmail" class="col-sm-4 col-form-label"></label>
                        <div class="col-sm-6">
                            <input type="button" onclick="createGraphic();" class="btn btn-success" value="Registrar Gràfico">
                        </div>
                    </div>
                </form>
            </div>
        </div> <!-- /.row -->
        <div class="card-body"></div>
    </div>
</div>

